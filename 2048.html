<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>2048</title>
  <style>
    body { display:flex; justify-content:center; align-items:center; height:100vh; background:#faf8ef; font-family:sans-serif; }
    #board { display:grid; grid-template-columns:repeat(4,100px); grid-template-rows:repeat(4,100px); gap:10px; }
    .tile { background:#cdc1b4; display:flex; justify-content:center; align-items:center; font-size:2em; font-weight:bold; border-radius:5px; }
    .tile[data-val="2"] { background:#eee4da; }
    .tile[data-val="4"] { background:#ede0c8; }
    .tile[data-val="8"] { background:#f2b179; color:white; }
    .tile[data-val="16"] { background:#f59563; color:white; }
    .tile[data-val="32"] { background:#f67c5f; color:white; }
    .tile[data-val="64"] { background:#f65e3b; color:white; }
    .tile[data-val="128"] { background:#edcf72; color:white; }
    .tile[data-val="256"] { background:#edcc61; color:white; }
    .tile[data-val="512"] { background:#edc850; color:white; }
    .tile[data-val="1024"] { background:#edc53f; color:white; }
    .tile[data-val="2048"] { background:#edc22e; color:white; }
  </style>
</head>
<body>
  <div id="board"></div>
  <script>
    const board=document.getElementById("board");
    let grid=Array(4).fill().map(()=>Array(4).fill(0));

    function draw(){
      board.innerHTML="";
      grid.flat().forEach(val=>{
        const div=document.createElement("div");
        div.className="tile";
        if(val){div.textContent=val;div.dataset.val=val;}
        board.appendChild(div);
      });
    }

    function addTile(){
      let empty=[];
      grid.forEach((r,i)=>r.forEach((c,j)=>{if(!c) empty.push([i,j]);}));
      if(empty.length){
        let [i,j]=empty[Math.floor(Math.random()*empty.length)];
        grid[i][j]=Math.random()<0.9?2:4;
      }
    }

    function slide(row){
      row=row.filter(c=>c);
      for(let i=0;i<row.length-1;i++){
        if(row[i]===row[i+1]){row[i]*=2;row[i+1]=0;}
      }
      row=row.filter(c=>c);
      while(row.length<4) row.push(0);
      return row;
    }

    function rotate(){
      let newGrid=Array(4).fill().map(()=>Array(4).fill(0));
      for(let i=0;i<4;i++) for(let j=0;j<4;j++) newGrid[i][j]=grid[j][3-i];
      grid=newGrid;
    }

    function moveLeft(){
      let old=JSON.stringify(grid);
      for(let i=0;i<4;i++) grid[i]=slide(grid[i]);
      if(JSON.stringify(grid)!==old){addTile();}
      draw();
    }

    document.addEventListener("keydown",e=>{
      if(e.key==="ArrowLeft") moveLeft();
      if(e.key==="ArrowRight"){rotate();rotate();moveLeft();rotate();rotate();draw();}
      if(e.key==="ArrowUp"){rotate();rotate();rotate();moveLeft();rotate();draw();}
      if(e.key==="ArrowDown"){rotate();moveLeft();rotate();rotate();rotate();draw();}
    });

    addTile(); addTile(); draw();
  </script>
</body>
</html>
